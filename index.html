<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
    <title>Jade2HTML2Jade</title>

    <link rel="stylesheet" type="text/css" href="ThirdParty/codemirror/lib/codemirror.css">
    <link rel="stylesheet" type="text/css" href="ThirdParty/codemirror/addon/hint/show-hint.css">
    <link rel="stylesheet" type="text/css" href="ThirdParty/codemirror/addon/lint/lint.css">
    <link rel="stylesheet" type="text/css" href="ThirdParty/codemirror/addon/scroll/simplescrollbars.css">
    <link rel="stylesheet" type="text/css" href="ThirdParty/codemirror/theme/ambiance.css">
    <link rel="stylesheet" type="text/css" href="ThirdParty/layout/source/stable/layout-default.css">
    <link rel="stylesheet" type="text/css" href="ThirdParty/bootstrap/dist/css/bootstrap.css">
    <link rel="stylesheet" type="text/css" href="ThirdParty/bootstrap/dist/css/bootstrap-theme.css">
    <link rel="stylesheet" type="text/css" href="Stylesheet/style.css">
    <link rel="stylesheet" type="text/css" media="print" href="Stylesheet/print.css">

    <script type="text/javascript" src="ThirdParty/layout/source/jquery/jquery-1.11.1.js"></script>
    <script type="text/javascript" src="ThirdParty/layout/source/jquery/jquery-ui-1.11.0.js"></script>
    
    <script type="text/javascript" src="ThirdParty/bootstrap/dist/js/bootstrap.js"></script>
    
    <!--<script type="text/javascript" src="ThirdParty/jshint/dist/jshint.js"></script>-->
    
    <script type="text/javascript" src="ThirdParty/codemirror/lib/codemirror.js"></script>
    
    <script type="text/javascript" src="ThirdParty/codemirror/addon/hint/anyword-hint.js"></script>
    <script type="text/javascript" src="ThirdParty/codemirror/addon/hint/css-hint.js"></script>
    <script type="text/javascript" src="ThirdParty/codemirror/addon/hint/html-hint.js"></script>
    <script type="text/javascript" src="ThirdParty/codemirror/addon/hint/javascript-hint.js"></script>
    <script type="text/javascript" src="ThirdParty/codemirror/addon/hint/show-hint.js"></script>
    
    <script type="text/javascript" src="ThirdParty/codemirror/addon/scroll/annotatescrollbar.js"></script>
    <script type="text/javascript" src="ThirdParty/codemirror/addon/scroll/scrollpastend.js"></script>
    <script type="text/javascript" src="ThirdParty/codemirror/addon/scroll/simplescrollbars.js"></script>
    
   
    <!--<script type="text/javascript" src="ThirdParty/codemirror/addon/lint/css-lint.js"></script>
    <script type="text/javascript" src="ThirdParty/codemirror/addon/lint/javascript-lint.js"></script>
    <script type="text/javascript" src="ThirdParty/codemirror/addon/lint/lint.js"></script>-->
    
    <script type="text/javascript" src="ThirdParty/codemirror/addon/fold/xml-fold.js"></script>
    
    <script type="text/javascript" src="ThirdParty/codemirror/addon/edit/matchbrackets.js"></script>
    <script type="text/javascript" src="ThirdParty/codemirror/addon/edit/matchtags.js"></script>
    <script type="text/javascript" src="ThirdParty/codemirror/addon/edit/closebrackets.js"></script>
    <script type="text/javascript" src="ThirdParty/codemirror/addon/edit/closetag.js"></script>
    <script type="text/javascript" src="ThirdParty/codemirror/addon/edit/continuelist.js"></script>
    <script type="text/javascript" src="ThirdParty/codemirror/addon/edit/trailingspace.js"></script>
    <script type="text/javascript" src="ThirdParty/codemirror/addon/display/placeholder.js"></script>
    
    <script type="text/javascript" src="ThirdParty/codemirror/mode/xml/xml.js"></script>
    <script type="text/javascript" src="ThirdParty/codemirror/mode/css/css.js"></script>
    <script type="text/javascript" src="ThirdParty/codemirror/mode/javascript/javascript.js"></script>
    <script type="text/javascript" src="ThirdParty/codemirror/mode/htmlmixed/htmlmixed.js"></script>
    <script type="text/javascript" src="ThirdParty/codemirror/mode/jade/jade.js"></script>
    
    <script type="text/javascript" src="ThirdParty/js-beautify/js/lib/beautify.js"></script>
    <script type="text/javascript" src="ThirdParty/js-beautify/js/lib/beautify-css.js"></script>
    <script type="text/javascript" src="ThirdParty/js-beautify/js/lib/beautify-html.js"></script>
    
    <script type="text/javascript" src="ThirdParty/jade/jade.js"></script>
    
	<script type="text/javascript" src="ThirdParty/layout/source/stable/jquery.layout.js"></script>
	
	<script type="text/javascript" src="ThirdParty/he/he.js"></script>
	
	<script type="text/javascript" src="ThirdParty/html2jade/lib/html2jade.js"></script>
	
</head>
<body>
    <!-- UI Layout with Code Editors -->
    <div id="container">
        <div class="pane ui-layout-east">
            <div id="editor-jade-wrapper">
                <textarea id="editor-jade" style="display: none;"></textarea>
            </div>
        </div>
    	<div class="pane ui-layout-center">
            <div id="editor-wrapper">
                <textarea id="editor-html" style="display: none;"></textarea>
            </div>
    	</div>
    </div>

    <!-- Right-Top Control Button Group -->
    <!-- on medium devices and larger -->
    <div class="btn-group hidden-xs hidden-sm" id="base-btn-group" role="group" aria-label="controlButtonGroupLabel">
        <button class="btn btn-success" id="about-button" title="About" data-toggle="modal" data-target="#aboutModal">
            <span class="glyphicon glyphicon-info-sign" aria-hidden="true"></span>
        </button>
        <button class="btn btn-danger" id="trashCode" onclick="trashCode();" title="Remove the code">
            <span class="glyphicon glyphicon-trash" aria-hidden="true"></span>
        </button>
        <button class="btn btn-success" id="parseJade" onclick="parseJade();" title="Convert Jade to HTML">
            <span class="glyphicon glyphicon-arrow-left" aria-hidden="true"></span>
        </button>
        <button class="btn btn-success" id="parseHTML" onclick="parseHTML();" title="Convert HTML to Jade">
            <span class="glyphicon glyphicon-arrow-right" aria-hidden="true"></span>
        </button>
    </div>
    <!-- on small devices and smaler -->
    <div class="btn-group-vertical hidden-md hidden-lg" id="base-btn-group" role="group" aria-label="controlButtonGroupLabel">
        <button class="btn btn-success" id="about-button" title="About" data-toggle="modal" data-target="#aboutModal">
            <span class="glyphicon glyphicon-info-sign" aria-hidden="true"></span>
        </button>
        <button class="btn btn-danger" id="trashCode" onclick="trashCode();" title="Remove the code">
            <span class="glyphicon glyphicon-trash" aria-hidden="true"></span>
        </button>
        <button class="btn btn-success" id="parseJade" onclick="parseJade();" title="Convert Jade to HTML">
            <span class="glyphicon glyphicon-arrow-left" aria-hidden="true"></span>
        </button>
        <button class="btn btn-success" id="parseHTML" onclick="parseHTML();" title="Convert HTML to Jade">
            <span class="glyphicon glyphicon-arrow-right" aria-hidden="true"></span>
        </button>
    </div>
    
    
    <!-- About Modal -->
    <div class="modal fade" id="aboutModal" tabindex="-1" role="dialog" aria-labelledby="printModalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                 <div class="modal-header" style="display:flex;padding:5px;" layout="row" layout-align="center">
                    <h4 class="modal-title text-center" id="printModalLabel" style="width:100%;padding-top: 5px;">Jade2HTML2Jade</h4>
                    <button type="button" class="btn btn-success" ria-label="CloseLabel" data-dismiss="modal">Close</button>
                </div>
                <div class="modal-body">
                    <p class="text-center">
                        Converts Jade into HTML and back
                        <br />
                        <br />
                        Version 0.2.0
                        <br />
                        <br />This software is licensed under the <a href="./LICENSE">MIT License (MIT)</a>.
                        <br />You can find the source code on <a href="https://github.com/JumpLink/jade2html2jade">GitHub</a>.
                    </p>
                    <p class="text-center">
                        Based on <a href="https://github.com/JumpLink/jade2html2jade">jade2html2jade</a>,
                        <br>
                        Modified by 85ido.
                    </p>
                    <p class="text-center">Copyright (c) 2015 Pascal Garber</p>
                </div>
            </div>
        </div>
    </div>
    
     <!-- Custom JavaScript -->
    <script type="text/javascript">
        var editorHtml;
        var editorJade;
        var htmlBeautifyOptions = {
            'indent_inner_html': true,
            'indent_size': 2,
            'indent_char': ' ',
            'wrap_line_length': 78,
            'brace_style': 'expand',
            'unformatted': ['a', 'sub', 'sup', 'b', 'i', 'u'],
            'preserve_newlines': true,
            'max_preserve_newlines': 5,
            'indent_handlebars': false,
        };
        var generalEditorOptions = {
            lineNumbers: true,
            viewportMargin: Infinity,
            lineWrapping: false,
            matchBrackets: true,
            autoCloseBrackets: true,
            matchTags: true,
            showTrailingSpace: true,
            autoCloseTags: true,
            hint: true,
            lint: true
        };

        // auto format / beautify the html code in html editor
        var formatHTML = function () {
            var htmlString = editorHtml.getValue();
            var cleanHtmlString = html_beautify(htmlString, htmlBeautifyOptions);
            editorHtml.setValue(cleanHtmlString);
        }
        
        // convert jade from jade edtor to html in html editor
        var parseJade = function () {
            var options = {
                pretty: true
            };
            var jadeString = editorJade.getValue();
            var htmlString = jade.render(jadeString, options);
            editorHtml.setValue(htmlString);
            formatHTML();
        }
        
        // convert html from html edtor to jade in jade editor
        var parseHTML = function () {
            var htmlString = editorHtml.getValue();
            Html2Jade.convertHtml(htmlString, {
                selectById: true,
                donotencode: true,
                noemptypipe: true
            }, function (err, jadeString) {
              if(err) {
                  console.error(err);
              } else {
                  editorJade.setValue(jadeString);
              }
            });
        }
        
        // Just for experiments
        var parseHTMLDocument = function () {
            var htmlString = editorHtml.getValue();
            var parser = new DOMParser();
            var htmlEditorDocument = parser.parseFromString(htmlString, "text/html");
            Html2Jade.convertDocument(htmlEditorDocument, {}, function (err, jadeString) {
              if(err) {
                  console.error(err);
              } else {
                  editorJade.setValue(jadeString);
              }
            });
        }
                
        // Remove the code from the editors
        var trashCode = function () {
            editorHtml.setValue('');
            editorJade.setValue('');
        }

        $(window).on('load', function() {
            var optionsJade = jQuery.extend({mode: 'jade', placeholder: 'Put Jade To Here'}, generalEditorOptions);
            var optionsHtml = jQuery.extend({mode: 'htmlmixed', placeholder: 'Put HTML To Here'}, generalEditorOptions);
            var layout = $('#container').layout(); // makes border drag-and-scaleable
            layout.sizePane('east', window.outerWidth / 2);
            editorJade = CodeMirror.fromTextArea(document.getElementById('editor-jade'),optionsJade);
            editorHtml = CodeMirror.fromTextArea(document.getElementById('editor-html'),optionsHtml);
        });
    </script>
</body>
</html> 